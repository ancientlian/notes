## Spring概念

### 特点

- 轻量级

> 零配置编程，API使用简单

- 面向Bean

> 只需要编写非常普通的Bean

- 松耦合

> 充分利用AOP思想

- 万能胶

> 与主流框架无缝集成

- 设计模式

> 将Java中经典的设计模式运行的彻底



### Spring采用了四个关键策略

**1.基于POJO的轻量级和最小侵入性编程；**

侵入性：代码的嵌套的使用；

独立开发合并运行减少侵入式；

**2.通过依赖注入和面向接口松耦合；**

依赖注入：以成员变量的形式把这个类的公共的代码引入像Spring的注入的方式有get，set方式， 构造方法注入；

**3.基于切面和惯性进行声明式编程；**

切面：AOP，使用的目的也是为了解耦，在Spring出现之前AOP只是一种思想，出现之后，使它变成一种现实，真正实现了代码与代码不相互嵌套，侵入，最终合在一起运行；典型的事务的管理；

**4.通过切面和模板减少样版式代码；**

像Spring jdbc, Spring mvc里面使用很多模板的概念，解决数据处理的逻辑；

像这些都是为了简化开发的；

### 面向Bean

Spring 是面向Bean的编程（Bean Oriented Programming，BOP），Bean在Spring中才是真正的主角，spring习惯叫做BOP编程

Spring里面有一个核心的**IOC容器**，主要是用来存储Bean的，保证Bean之间的依赖关系，**Spring**

**提供IOC容器通过配置文件或者注解的方式来管理对象之间的依赖关系**；

 

**控制反转**（其中最常见的方式叫做**依赖注入** （Dependency Injection，DI）,还有一种方式叫“依赖查找”

（Dependency Lookup，DL），它在C++，Java，PHP以及.NET中运用。在最早的Spring是包含有依赖注入方法和依赖查询的，但是因为依赖查询使用频率过低，不久就被Spring移除了，**所以在Spring中**

**控制反转也被称作依赖注入**），它的基本概念是：不创建对象，但是描述创建它们的方式，在代码中不直接与对象和服务连接，但在配置文件中描述哪一个组件需要哪一项服务。容器（在Spring框架中是IOC容器） 负责将这些联系在一起。

```java
class A{
    int a;
    int b;
    public void execute(){}
}
//在普通的类中，我们需要实例化之后用一个变量保存下来（或者是匿名对象）
A a = new A();
```

但是在spring中：

```java
@Autowire A a；
//Spring 初始化，实例化，现在没有new()也实例化了，也就是说这个控制权交给spring了，控制反转
```

spring创建的对象是有Spring容器来保存（也就是IOC容器），用来存储java bean对象；
与此类似的是Web容器，它是用来装Servlet的

I**OC最终的目的是实现依赖注入**

在典型的IOC场景中容器创建了所有对象，并设置必要的属性将它们连接在一起，决定什么时间调用方法

### 依赖注入

Spring 设计的核心 org.springframework.beans包（架构核心是org.springframework.core包），它设计目的是与JavaBean组件一起使用。这个包通常不是由用户直接使用，而是由服务器将其用作其他多数功能的底层中介，下一个最高级抽象是BeanFactory接口，它是工厂设计模式的实现，允许通过名称创建和检索对象。BeanFactory 也可以管理对象之间的关系。

BeanFacory支持两种对象模型，其一：单例：模型提供了具有特定名称的对象共享实例，可以在查询时对其进行检索。Signgleton是默认的也是最常见的对象模型。对于无状态服务对象很理想。其二：原型: 模型确保每次检索都会创建单独的对象，在每个用户都需要自己的对象时，原型模型最适合。

bean工厂的概念是Spring作为IOC容器的基础。IOC则将处理事情的责任从应用程序代码转移到框架。

```java
//实现依赖注入（赋值）

@Autowired Interface A a ; //自动把它的实现类注入进来

@Resource("aaa") A b ;// IOC容器中类的id为aaa对象自动注入到这里（可区分父子类）

@Autowired A a; //根据类型自动注入
```

依赖链中所有的对象，IOC容器里面初始化，实例化是按照先后顺序进行的；

Spring的注入方式

1.setter

2.构造方式

3.强制赋值 如`@Autowired private Interface A a ; //也可以自动把它的实现类注入进来`

### 面向切面

面向切面编程，即AOP，是一种编程思想，它允许程序员对横切关注点或横切典型的职责分界线的行为（例如日志和事务管理）进行模块化。AOP的核心构造是方便将哪些影响多个类的行为封装到可重用的模块中。

Aop和IOC是补充性的技术，它们都运用模块化方式解决企业应用程序开发中的复杂问题。在典型

的面向对象开发方式中，可能要将日志记录语句放在所有方法和Java类中才能实现日志功能。在AOP方式中，可以反过来将日志服务模块化，并以声明的方式将它们应用到需要日志的组件上，当然，优势就是Java类不需要知道日志服务的存在，也不需要考虑相关的代码，所以，用Spring AOP编写的用用程序代码是松耦合的；

AOP一定要达到无缝合并，否则就不叫AOP，AOP核心切面即规则目的解耦；

AOP核心思想： 实现AOP编程，先把一个整体拆开，分别开发，等到发布的时候，再组装到一起运行；拆开是要**按照一定的规则，这个规则就是切面，一个切面就是一个规则**，面向切面编程就是要怎么去定义这个规则；

总结AOP思想：**解耦**

AOP的功能完全集成到了Spring事务管理、日志和其他各种特性的上下文中。

## 俯瞰Spring架构设计

### 3.1系统架构

Spring总共大约由20个模块，由1300多个不同的文件构成。而这些组件被分别整合在核心容器（Core Container）、AOP（Aspect Oriented Programming）和设备支持（Instrmentation）、数据访问及集成（Data Access/Integration）、Web、报文发送（Messaging）、Test，6个模块集合中。

